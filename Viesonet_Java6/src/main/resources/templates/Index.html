<!doctype html>
<html ng-app="myApp">

<head>
<!-- Required meta tags -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
	crossorigin="anonymous">
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
	crossorigin="anonymous"></script>
<script src="https://kit.fontawesome.com/f737751420.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
	href="https://fonts.googleapis.com/css2?family=Alumni+Sans+Inline+One&family=Bangers&family=Chakra+Petch:ital,wght@0,400;1,300;1,400;1,700&family=Grenze&family=Patrick+Hand&family=Playfair+Display+SC&family=Road+Rage&display=swap"
	rel="stylesheet">
<link rel="stylesheet" href="/css/style.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
	href="https://fonts.googleapis.com/css2?family=Alumni+Sans+Inline+One&family=Bangers&family=Chakra+Petch:ital,wght@0,400;1,300;1,400;1,700&family=Grenze&family=Patrick+Hand&family=Roboto&display=swap"
	rel="stylesheet">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script
	src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>

<title>Trang chủ</title>
<style type="text/css">
.dropdown-item {
	padding-top: 0;
	padding-bottom: 0;
}

.red-heart {
	color: red;
	/* Màu đỏ cho trái tim đã thích */
}

.gray-heart {
	color: gray;
	/* Màu xám cho trái tim chưa thích */
}

div.dropdown-menu.baoCao {
	transform: translate(-80%, 39px);
}

.container, .container-lg, .container-md, .container-sm, .container-xl {
	max-width: 100%;
}

.dropdown {
	position: relative;
	display: inline-block;
}

.dropdown-content {
	display: none;
	opacity: 0;
	position: absolute;
	background-color: #f9f9f9;
	min-width: 17rem;
	box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
	z-index: 1;
	padding-right: 10px;
	border-radius: 3px;
	transition: 0.5s ease-in-out;
}

.dropdown-content a {
	color: black;
	padding: 12px 16px;
	text-decoration: none;
	display: block;
}

.dropdown:hover .dropdown-content {
	display: block;
	transition: 0.5s ease-in-out;
	opacity: 1;
}

.uploaded-image {
	width: 100%;
	max-width: 100%;
	height: auto;
	margin-bottom: 7px;
}
</style>

<script
	src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
<script src="/js/thoiTiet.js"></script>
</head>

<body style="padding-top: 70px;" ng-controller="myCtrl">
	<div style="transition: 0.5s;">
		<div class="row ">
			<aside class="left-sidebar animate__animated animate__backInRight"
				style="z-index: 100; position: fixed; top: 0;">
				<div>
					<div
						class="brand-logo d-flex align-items-center justify-content-between">
						<a href="./index.html" class="text-nowrap logo-img"
							style="color: #222; font-weight: bolder; font-family: 'robo';">
							<img src="images/chimLac.png" height="30px" alt="">
							VIE_SONET
						</a>
					</div>
					<nav class="sidebar-nav scroll-sidebar" data-simplebar="init">
						<div class="simplebar-wrapper" style="margin: 0px -24px;">
							<div class="simplebar-height-auto-observer-wrapper">
								<div class="simplebar-height-auto-observer"></div>
							</div>
							<div class="simplebar-mask">
								<div class="simplebar-offset" style="right: 0px; bottom: 0px;">
									<div class="simplebar-content-wrapper"
										style="height: 100%; overflow: hidden;">
										<div class="simplebar-content" style="padding: 0px 24px;">
											<ul id="sidebarnav">
												<li class="nav-small-cap"><i
													class="ti ti-dots nav-small-cap-icon fs-4"></i> <span
													class="hide-menu">Chung</span></li>
												<li class="sidebar-item"><a class="sidebar-link"
													href="#" aria-expanded="false"> <span> <i
															class="fa-sharp fa-regular fa-house"></i>
													</span> <span class="hide-menu">&nbsp; Trang chủ</span>
												</a></li>
												<li class="sidebar-item"><a class="sidebar-link"
													href="#" aria-expanded="false"> <span> <i
															class="fa-regular fa-magnifying-glass"></i>
													</span> <span class="hide-menu">&nbsp; Tìm kiếm</span>
												</a></li>
												<li class="sidebar-item"><a class="sidebar-link"
													href="#" aria-expanded="false"> <span> <i
															class="fa-light fa-handshake"></i>
													</span> <span class="hide-menu">&nbsp; Gợi ý</span>
												</a></li>
												<li class="sidebar-item"><a class="sidebar-link"
													href="#" aria-expanded="false"> <span> <i
															class="fa-regular fa-messages"></i>
													</span> <span class="hide-menu">&nbsp; Tin nhắn</span>
												</a></li>
												<li class="nav-small-cap"><i
													class="ti ti-dots nav-small-cap-icon fs-4"></i> <span
													class="hide-menu">Quản Lý</span></li>
												<li class="sidebar-item"><a class="sidebar-link active"
													href="#" aria-expanded="false"> <span> <svg
																class="svg-inline--fa fa-users" aria-hidden="true"
																focusable="false" data-prefix="far" data-icon="users"
																role="img" xmlns="http://www.w3.org/2000/svg"
																viewBox="0 0 640 512" data-fa-i2svg="">
                                                                <path
																	fill="currentColor"
																	d="M144 160A80 80 0 1 0 144 0a80 80 0 1 0 0 160zm368 0A80 80 0 1 0 512 0a80 80 0 1 0 0 160zM0 298.7C0 310.4 9.6 320 21.3 320H234.7c.2 0 .4 0 .7 0c-26.6-23.5-43.3-57.8-43.3-96c0-7.6 .7-15 1.9-22.3c-13.6-6.3-28.7-9.7-44.6-9.7H106.7C47.8 192 0 239.8 0 298.7zM405.3 320H618.7c11.8 0 21.3-9.6 21.3-21.3C640 239.8 592.2 192 533.3 192H490.7c-15.9 0-31 3.5-44.6 9.7c1.3 7.2 1.9 14.7 1.9 22.3c0 38.2-16.8 72.5-43.3 96c.2 0 .4 0 .7 0zM320 176a48 48 0 1 1 0 96 48 48 0 1 1 0-96zm0 144a96 96 0 1 0 0-192 96 96 0 1 0 0 192zm-58.7 80H378.7c39.8 0 73.2 27.2 82.6 64H178.7c9.5-36.8 42.9-64 82.6-64zm0-48C187.7 352 128 411.7 128 485.3c0 14.7 11.9 26.7 26.7 26.7H485.3c14.7 0 26.7-11.9 26.7-26.7C512 411.7 452.3 352 378.7 352H261.3z">
                                                                </path>
                                                            </svg> <!-- <i class="fa-regular fa-users"></i> -->
													</span> <span class="hide-menu">Người dùng</span>
												</a> <a class="sidebar-link" href="#" aria-expanded="false">
														<span> <svg class="svg-inline--fa fa-memo-pad"
																aria-hidden="true" focusable="false" data-prefix="far"
																data-icon="memo-pad" role="img"
																xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"
																data-fa-i2svg="">
                                                                <path
																	fill="currentColor"
																	d="M400 128V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V128H400zM64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM96 200c0 13.3 10.7 24 24 24H328c13.3 0 24-10.7 24-24s-10.7-24-24-24H120c-13.3 0-24 10.7-24 24zm0 96c0 13.3 10.7 24 24 24H328c13.3 0 24-10.7 24-24s-10.7-24-24-24H120c-13.3 0-24 10.7-24 24zm0 96c0 13.3 10.7 24 24 24H232c13.3 0 24-10.7 24-24s-10.7-24-24-24H120c-13.3 0-24 10.7-24 24z">
                                                                </path>
                                                            </svg> <!-- <i class="fa-regular fa-memo-pad"></i> -->
													</span> <span class="hide-menu"> &nbsp; &nbsp;Bài viết</span>
												</a> <a class="sidebar-link" href="#" aria-expanded="false">
														<span> <svg
																class="svg-inline--fa fa-memo-circle-info"
																aria-hidden="true" focusable="false" data-prefix="far"
																data-icon="memo-circle-info" role="img"
																xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"
																data-fa-i2svg="">
                                                                <path
																	fill="currentColor"
																	d="M320 48H64c-8.8 0-16 7.2-16 16V448c0 8.8 7.2 16 16 16H284.5c12 18.4 27.4 34.5 45.3 47.3c-3.2 .5-6.4 .7-9.7 .7H64c-35.3 0-64-28.7-64-64V64C0 28.7 28.7 0 64 0H320c35.3 0 64 28.7 64 64V198.6c-17.2 4.9-33.4 12.3-48 21.8V64c0-8.8-7.2-16-16-16zM96 152c0-13.3 10.7-24 24-24H264c13.3 0 24 10.7 24 24s-10.7 24-24 24H120c-13.3 0-24-10.7-24-24zm24 72H264c13.3 0 24 10.7 24 24s-10.7 24-24 24H120c-13.3 0-24-10.7-24-24s10.7-24 24-24zm0 96h48c13.3 0 24 10.7 24 24s-10.7 24-24 24H120c-13.3 0-24-10.7-24-24s10.7-24 24-24zm312-96a144 144 0 1 1 0 288 144 144 0 1 1 0-288zm0 96a24 24 0 1 0 0-48 24 24 0 1 0 0 48zm-32 48c0 8.8 7.2 16 16 16h0v48h0c-8.8 0-16 7.2-16 16s7.2 16 16 16h16 16c8.8 0 16-7.2 16-16s-7.2-16-16-16V368c0-8.8-7.2-16-16-16H416c-8.8 0-16 7.2-16 16z">
                                                                </path>
                                                            </svg> <!-- <i class="fa-regular fa-memo-circle-info"></i> -->
													</span> <span class="hide-menu"> &nbsp; Bài viết vi phạm</span>
												</a></li>
											</ul>
										</div>
									</div>
								</div>
							</div>
							<div class="simplebar-placeholder"
								style="width: auto; height: 312px;"></div>
						</div>
						<div class="simplebar-track simplebar-horizontal"
							style="visibility: hidden;">
							<div class="simplebar-scrollbar"
								style="width: 0px; display: none;"></div>
						</div>
						<div class="simplebar-track simplebar-vertical"
							style="visibility: hidden;">
							<div class="simplebar-scrollbar"
								style="height: 0px; display: none;"></div>
						</div>
					</nav>
				</div>
			</aside>
			<nav class="navbar navbar-expand-sm "
				style="padding: 0; position: fixed; top: 0; z-index: 101">
				<div class="container" style="width: 100%; padding: 0;">
					<div class="collapse navbar-collapse" id="collapsibleNavId">
						<ul class="navbar-nav me-auto mt-2 mt-lg-0">
						</ul>
						<div class="body-wrapper">
							<header class="app-header">
								<nav class="navbar navbar-expand-lg navbar-light">
									<div class="navbar-collapse justify-content-end px-0"
										id="navbarNav">
										<ul
											class="navbar-nav flex-row ms-auto align-items-center justify-content-end">
											<li class="nav-item dropdown"><a
												class="nav-link nav-icon-hover" href="#" id="drop2"
												data-bs-toggle="dropdown" aria-expanded="false"> <svg
														class="svg-inline--fa fa-bell" aria-hidden="true"
														focusable="false" data-prefix="far" data-icon="bell"
														role="img" xmlns="http://www.w3.org/2000/svg"
														viewBox="0 0 448 512" data-fa-i2svg="">
                                                        <path
															fill="currentColor"
															d="M224 0c-17.7 0-32 14.3-32 32V49.9C119.5 61.4 64 124.2 64 200v33.4c0 45.4-15.5 89.5-43.8 124.9L5.3 377c-5.8 7.2-6.9 17.1-2.9 25.4S14.8 416 24 416H424c9.2 0 17.6-5.3 21.6-13.6s2.9-18.2-2.9-25.4l-14.9-18.6C399.5 322.9 384 278.8 384 233.4V200c0-75.8-55.5-138.6-128-150.1V32c0-17.7-14.3-32-32-32zm0 96h8c57.4 0 104 46.6 104 104v33.4c0 47.9 13.9 94.6 39.7 134.6H72.3C98.1 328 112 281.3 112 233.4V200c0-57.4 46.6-104 104-104h8zm64 352H224 160c0 17 6.7 33.3 18.7 45.3s28.3 18.7 45.3 18.7s33.3-6.7 45.3-18.7s18.7-28.3 18.7-45.3z">
                                                        </path>
                                                    </svg>
													<div class="circle mb-2"></div>
											</a>
												<div style="background: whitesmoke;"
													class="dropdown-menu dropdown-menu-end dropdown-menu-animate-up"
													aria-labelledby="drop2">
													<div class="message-body">
														<a href="#"
															class="d-flex align-items-center gap-2 dropdown-item">
															<i class="ti ti-user fs-6"></i>
															<p class="mb-0 fs-3">Thông báo 1</p>
														</a> <a href="#"
															class="d-flex align-items-center gap-2 dropdown-item">
															<i class="ti ti-user fs-6"></i>
															<p class="mb-0 fs-3">Thông báo 2</p>
														</a> <a href="#"
															class="d-flex align-items-center gap-2 dropdown-item">
															<i class="ti ti-user fs-6"></i>
															<p class="mb-0 fs-3">Thông báo 3</p>
														</a>
													</div>
												</div></li>
											<li class="nav-item dropdown"><a
												class="nav-link nav-icon-hover" href="#" id="drop2"
												data-bs-toggle="dropdown" aria-expanded="false"> <img
													src="images/duyQuy.jpg" alt="" width="35" height="35"
													class="rounded-circle">
											</a>
												<div style="background: whitesmoke;"
													class="dropdown-menu dropdown-menu-end dropdown-menu-animate-up"
													aria-labelledby="drop2">
													<div class="message-body">
														<a href="/changepassword"
															class="d-flex align-items-center gap-2 dropdown-item">
															<i class="ti ti-user fs-6"></i>
															<p class="mb-0 fs-3">Đổi mật khẩu</p>
														</a> <a href="#"
															class="d-flex align-items-center gap-2 dropdown-item">
															<i class="ti ti-mail fs-6"></i>
															<p class="mb-0 fs-3">Thông tin điều khoản</p>
														</a> <a href="#"
															class="d-flex align-items-center gap-2 dropdown-item">
															<i class="ti ti-list-check fs-6"></i>
															<p class="mb-0 fs-3">Nâng cấp</p>
														</a> <a ng-click="logout()"
															class="btn btn-outline-primary mx-3 mt-2 d-block">Đăng
															xuất</a>
													</div>
												</div></li>
										</ul>
									</div>
								</nav>
							</header>
							<div class="container-fluid">
								<div class="row"></div>
							</div>

						</div>
					</div>
				</div>
			</nav>

			<div class="col-md-6 offset-md-3 " style="z-index: 10;">
				<center>

					<div
						style="width: 85%; text-align: left; background-color: transparent;"
						data-bs-toggle="modal" href="#exampleModalToggle">
						<div>
							<div
								class="write-post-container  img-thumbnail animate__animated animate__backInLeft"
								style="margin-bottom: 15px; background: white 0.5; border-radius: 3px 3px 0 0; padding-top: 10px; padding-bottom: 10px; background-color: transparent; background-image: url('/images/347236939_2465911110227431_5952883918790101011_n.jpg-20230616.jpg'); background-size: cover; min-height: 15rem">
								<span
									style="font-weight: 600 !important; font-size: 1rem !important; margin: 0; color: white"><i
									class="fa-solid fa-pencil"></i> Đăng bài viết</span>
								<form id="postForm">
									<center>
										<img id="img" src="" width="45%"
											style="border-radius: 10px; border: 1px solid rgb(184, 182, 182)">
									</center>
									<textarea class="form-control"
										placeholder="Hãy viết gì đó cho ngày hôm nay..."
										id="floatingTextarea2" style="height: 137px; opacity: 0.4"></textarea>
								</form>
								<div class="d-flex  gap-2"
									style="margin-top: 5px; text-align: right;"></div>
							</div>
						</div>
					</div>
				</center>

				<center>
					<div ng-repeat="post in Posts">
						<div
							class="write-post-container   animate__animated animate__backInLeft"
							style="margin-bottom: 20px; border-radius: 2px; padding: 0; padding-top: 10px; padding-bottom: 10px; width: 85%; text-align: left; background: white;">
							<div style="margin: 0;">
								<div
									style="display: flex; align-items: center; justify-content: space-between; padding-left: 10px">
									<div class="dropdown">
										<span class="dropbtn"><div class="user-profile ">
												<a href="/nguoiDung/0111111118"><img
													ng-src="/images/{{post.user.avatar }}"
													style="border-radius: 100%;" alt=""></a>
												<div>

													<span
														style="font-weight: 600 !important; font-size: 1rem !important; margin: 0; color: #2A3547">{{
														post.user.username }}</span>
													<!-- <i class="fa-solid fa-earth-americas fa-xs"></i> -->
													<span><small style="font-size: 12px; color: #65676b">
															{{ getFormattedTimeAgo(post.postDate) }} </small></span>
												</div>
											</div></span>
										<div class="dropdown-content">
											<div class="user-profile ">
												<a href="/nguoiDung/0111111118"><img
													ng-src="/images/{{ post.user.avatar }}"
													style="border-radius: 100%;" alt=""></a>
												<div>
													<label>{{ post.user.username }}</label>
													<!-- <i class="fa-solid fa-earth-americas fa-xs"></i> -->
													<br> <small style="font-size: 12px; color: #65676b">
														<b>Sống tại:</b> {{ post.user.address }}
													</small> <br> <small style="font-size: 12px; color: #65676b">
														<b>Mối quan hệ:</b> {{ post.user.relationship }}
													</small>

												</div>
											</div>
										</div>
									</div>


									<div>
										<div class="btn-group" style="margin-right: 10px;">
											<div class="dropdown">
												<span class="  dropdown-toggle" id="triggerId"
													data-bs-toggle="dropdown" aria-haspopup="true"
													aria-expanded="false"> </span>
												<div class="dropdown-menu" aria-labelledby="triggerId">
													<a class="dropdown-item" href="#" style="color: #E53F31;">Báo
														cáo vi phạm</a>
													<div class="dropdown-divider"></div>
													<a class="dropdown-item" href="">Xem trang cá nhân</a>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div style="margin-top: 10px;">
									<div>
										<div
											style="box-sizing: border-box; padding-left: 5px; padding-right: 5px; font-size: 13px;">
											{{ post.content }}</div>
										<center>
											<div ng-if="post.images.length > 1">
												<!-- Carousel HTML code -->
												<div id="carouselId" class="carousel slide"
													data-bs-ride="carousel">
													<!-- Carousel indicators -->
													<ol class="carousel-indicators">
														<li data-bs-target="#carouselId"
															ng-repeat="image in post.images track by $index"
															ng-class="{ 'active': $index === 0 }"
															data-bs-slide-to="{{$index}}"
															aria-current="{{$index === 0}}"
															aria-label="Slide {{$index + 1}}"></li>
													</ol>
													<!-- Carousel items -->
													<div ng-click="getPostDetails(post.postId)"
														class="carousel-inner" role="listbox">
														<div class="carousel-item"
															style="background-color: #313131; height: 90vh;"
															ng-repeat="image in post.images track by $index"
															ng-class="{ 'active': $index === 0 }">
															<img ng-src="/images/{{ image.imageUrl }}"
																class="w-100 d-block" alt="Slide {{$index + 1}}"
																style="max-height: 90vh; object-fit: contain; width: 100%; transform: translateY(-50%); top: 50%; position: absolute;">
														</div>
													</div>
													<!-- Carousel controls -->
													<button class="carousel-control-prev" type="button"
														data-bs-target="#carouselId" data-bs-slide="prev">
														<span class="carousel-control-prev-icon"
															aria-hidden="true"></span> <span class="visually-hidden">Previous</span>
													</button>
													<button class="carousel-control-next" type="button"
														data-bs-target="#carouselId" data-bs-slide="next">
														<span class="carousel-control-next-icon"
															aria-hidden="true"></span> <span class="visually-hidden">Next</span>
													</button>
												</div>
											</div>
											<div ng-if="post.images.length === 1">
												<!-- Single image HTML code -->
												<img ng-click="getPostDetails(post.postId)"
													ng-src="/images/{{ post.images[0].imageUrl }}"
													class="w-100" alt="Single image">
											</div>


										</center>
									</div>

									<div class="post-reaction"
										style="padding-left: 10px; margin-top: 8px;">
										<div class="activity-icons">
											<div>
												<span ng-click="likePost(post.postId);"
													ng-if="likedPosts.indexOf(post.postId.toString()) !== -1"
													style="color: #f50000;">❤️&nbsp;{{ post.likeCount }}</span>
												<span ng-click="likePost(post.postId)"
													ng-if="likedPosts.indexOf(post.postId.toString()) === -1">🤍&nbsp;{{
													post.likeCount }}</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
													ng-click="getPostDetails(post.postId)"><i
													class="fa-light fa-comments"></i>&nbsp;{{ post.commentCount
													}}</span>
											</div>
										</div>
									</div>

								</div>
							</div>
						</div>
					</div>
				</center>
			</div>
			<div class="col-md-3 menuLeft animate__animated animate__backInRight"
				style="position: fixed; right: 3%; top: 70px;">
				<div class="user-data full-width"
					style="margin-bottom: 5px; margin-left: 0">
					<div class="user-profile" style="display: block;">
						<div class="username-dt dpbg-1"
							style="background-image: url(images/{{myAccount.user.background}}); background-size: cover;">
							<div class="usr-pic">
								<img ng-src="/images/{{myAccount.user.avatar}}" alt="">
							</div>
						</div>
						<div class="user-main-details">
							<h6 style="font-weight: 600">{{myAccount.user.username}}</h6>
							<!-- <span><i class="feather-map-pin"></i>India</span> -->
						</div>
						<ul class="followers-dts">
							<li>
								<div class="followers-dt-sm">
									<h4>Người theo dõi</h4>
									<span>{{myAccount.followers}}</span>
								</div>
							</li>
							<li>
								<div class="followers-dt-sm">
									<h4>Đang theo dõi</h4>
									<span>{{myAccount.following}}</span>
								</div>
							</li>
						</ul>
						<div class="profile-link">

							<a class="btn-blue" href="/profile"
								style="background-color: #3b5998; border-radius: 2px; border: 1px solid #3b5998; box-sizing: border-box; color: white; display: inline-block; font-family: Arial, sans-serif; font-size: 14px; line-height: 16.8px; margin: 0px 3px 10px; padding: 10px 14px; text-decoration-line: none; transition: all 0.2s; width: 98%;"
								rel="noopener noreferrer"><i
								class="fa-light fa-address-card"></i> Xem trang cá nhân </a>
						</div>

					</div>
				</div>
				<div class="row">
					<div>
						<div
							style="background-color: #f2f2f2; border: 1px solid grey; background: url(images/beach.jpg); background-size: cover; color: #234662; padding: 0; width: 100%; max-height: 188px; border-radius: 3px">
							<div id="weather-info"
								style="background-color: rgba(0, 0, 0, 0.4); margin: 0; padding: 10px; color: #F2E5C9;">

								<ul style="font-size: 13px">
									<li><b>Thành phố:</b> <span id="city"></span></li>
									<li><b>Nhiệt độ:</b> <span id="temperature"></span> °C</li>
									<li><b>Mô tả:</b> <span id="description"></span></li>
									<li><b>Độ ẩm:</b> <span id="humidity"></span>%</li>
									<li><b>Tốc độ gió:</b> <span id="wind-speed"></span> m/s</li>
								</ul>
							</div>
						</div>
					</div>
				</div>

			</div>
		</div>
	</div>
	<!-- Modal đăng bài -->
	<div class="modal fade" id="exampleModalToggle" aria-hidden="true"
		aria-labelledby="exampleModalToggleLabel" tabindex="-1">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content"
				style="background-color: rgba(246, 245, 244, 1);">
				<div class="modal-header">
					<h5 class="modal-title" id="exampleModalToggleLabel">
						<b style="margin-left: 170px;">Đăng bài viết</b>
					</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"
						aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<form id="postForm" enctype="multipart/form-data">
						<div class="user-profile">
							<img ng-src="images/{{ myAccount.user.avatar }}" alt="">
							<div>
								<label>{{myAccount.user.username}}</label> <br>
								<div style="display: flex; align-items: center;">
									<div class="circle mb-2"
										style="margin-bottom: 0 !important; background-color: green"></div>
									&nbsp; <small style="font-size: 12px"> Đang hoạt động </small>
								</div>
							</div>
						</div>
						<br>
						<textarea name="content" placeholder="Bạn đang nghĩ gì?"
							id="content" ng-model="postData.content" cols="30" rows="3"
							style="width: 100%; border: 0px; outline: none; border-bottom: 1px solid #ccc; background: transparent; resize: none;"></textarea>
						<br>
						<center>
							<img id="img" src="" width="45%"
								style="border-radius: 10px; border: 1px solid rgb(184, 182, 182)">
						</center>
						<div id="imageList"></div>
						<div class="input-group mb-3">
							<label class="input-group-text" for="inputGroupFile01"> <i
								class="fa-regular fa-image"></i>Hình ảnh
							</label> <input type="file" class="form-control" name="photoFiles"
								id="inputGroupFile01" multiple accept="image/*">
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button ng-click="post()" style="width: 500px; border: none;"
						class="btn-blue" data-bs-target="#exampleModalToggle2"
						data-bs-toggle="modal" data-bs-dismiss="modal">Đăng bài</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal hiện  chi tiêt bài viết và danh sách bình luận -->
	<div class="modal fade" id="chiTietBaiViet" tabindex="-1" role="dialog"
		aria-labelledby="modalTitleId" aria-hidden="true">
		<div class="modal-dialog modal-xl modal-fullscreen" role="document">
			<div class="modal-content">
				<div class="modal-body">
					<div class="row">
						<div class="col-md-6 trai "
							style="overflow-y: scroll; max-height: 100vh">
							<center>
								<center>
									<div ng-if="postDetails.images.length > 1">
										<!-- Carousel HTML code -->
										<div id="postDetails{{postDetails.postid}}"
											class="carousel slide" data-bs-ride="carousel">
											<!-- Carousel indicators -->
											<ol class="carousel-indicators">
												<li data-bs-target="#postDetails{{postDetails.postid}}"
													ng-repeat="image in postDetails.images track by $index"
													ng-class="{ 'active': $index === 0 }"
													data-bs-slide-to="{{$index}}"
													aria-current="{{$index === 0}}"
													aria-label="Slide {{$index + 1}}"></li>
											</ol>
											<!-- Carousel items -->
											<div class="carousel-inner" role="listbox">
												<div class="carousel-item"
													ng-repeat="image in postDetails.images track by $index"
													ng-class="{ 'active': $index === 0 }">
													<img ng-src="/images/{{ image.imageUrl }}"
														class="w-100 d-block" alt="Slide {{$index + 1}} ">
												</div>
											</div>
											<!-- Carousel controls -->
											<button class="carousel-control-prev" type="button"
												data-bs-target="#postDetails{{postDetails.postid}}"
												data-bs-slide="prev">
												<span class="carousel-control-prev-icon" aria-hidden="true"></span>
												<span class="visually-hidden">Previous</span>
											</button>
											<button class="carousel-control-next" type="button"
												data-bs-target="#postDetails{{postDetails.postid}}"
												data-bs-slide="next">
												<span class="carousel-control-next-icon" aria-hidden="true"></span>
												<span class="visually-hidden">Next</span>
											</button>
										</div>
									</div>
									<div ng-if="postDetails.images.length === 1">
										<!-- Single image HTML code -->
										<img ng-src="/images/{{ postDetails.images[0].imageUrl }}"
											class="w-100" alt="Single image"
											style="margin-top: 10px; margin-bottom: 10px; max-height: 90vh; object-fit: cover;">
									</div>
								</center>
							</center>
						</div>
						<div class="col-md-6 phai ">
							<div>
								<div data-bs-dismiss="modal"
									style="cursor: pointer; text-align: right;">X</div>
								<div
									style="display: flex; align-items: center; justify-content: space-between;">
									<div class="user-profile">
										<img src="/images/sonTungAvt.jpg" class="img-thumbnail" alt="">
										<div>
											<label class="nhan">{{postDetails.user.username}}</label><br>
											<small style="font-size: 12px; color: #65676b">{{getFormattedTimeAgo(postDetails.postDate)}}</small>
										</div>
									</div>

									<div>
										<div class="btn-group">
											<span class="btn dropdown-toggle" type="button"
												id="triggerId" data-bs-toggle="dropdown"
												aria-haspopup="true" aria-expanded="false"></span>
											<div class="dropdown-menu" aria-labelledby="triggerId">
												<a class="dropdown-item" href="#">Báo cáo vi phạm</a>
											</div>
										</div>
									</div>
								</div>
								<div>{{postDetails.content}}</div>
								<form>
									<div style="display: flex; flex-direction: column;">
										<input ng-model="myComment" type="text"
											class="ip form-control" style="width: 80%;"
											placeholder="Bình luận của bạn" required="">
										<button class="btn01" type="submit"
											style="background: #007ACC; color: white;"
											ng-click="addComment(postDetails.postId)">Bình luận</button>
									</div>
								</form>
							</div>
							<center>
								<hr style="width: 10%; text-align: center;">
							</center>
							<div style="overflow-y: scroll; max-height: 60vh">
								<div ng-repeat="comment in postComments">
									<div
										class="user-profile animate__animated animate__headShake img-thumbnail"
										style="box-sizing: border-box; padding: 4px; border-radius: 5px; background-color: white; margin-bottom: 10px; background-color: rgba(246, 249, 252); border: 1px solid gray">
										<img ng-src="/images/{{comment.user.avatar}}"
											class="img-thumbnail" alt="">
										<div>
											<div>
												<label class="nhan" style="font-size: 15px;">{{comment.user.username}}</label>
											</div>
											<small style="font-size: 12px;"> <svg
													class="svg-inline--fa fa-comment" aria-hidden="true"
													focusable="false" data-prefix="far" data-icon="comment"
													role="img" xmlns="http://www.w3.org/2000/svg"
													viewBox="0 0 512 512" data-fa-i2svg="">
                    <path fill="currentColor"
														d="M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c8.6 9.7 12.8 22.5 11.8 35.5c-1.4 18.1-5.7 34.7-11.3 49.4c17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9c1.8-2.7 3.5-5.4 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208s-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6c-15.1 6.6-32.3 12.6-50.1 16.1c-.8 .2-1.6 .3-2.4 .5c-4.4 .8-8.7 1.5-13.2 1.9c-.2 0-.5 .1-.7 .1c-5.1 .5-10.2 .8-15.3 .8c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c4.1-4.2 7.8-8.7 11.3-13.5c1.7-2.3 3.3-4.6 4.8-6.9c.1-.2 .2-.3 .3-.5z"></path>
                </svg> {{comment.content}}
											</small><br>
											<div>
												<small style="font-size: 10px;">{{getFormattedTimeAgo(comment.commentDate)}}</small>
												&nbsp; <label> <input type="checkbox"
													ng-model="o_checkbox" hidden="true"> <small
													ng-if="comment.reply.length > 0"
													style="font-size: 10px; cursor: pointer;">{{comment.reply.length}}
														phản hồi</small>
												</label> &nbsp; <small style="font-size: 10px; cursor: pointer;">
													<label> <input type="checkbox" ng-model="o_reply"
														hidden="true"> <i class="fa-sharp fa-regular fa-reply"></i> Trả lời
												</label>
												</small>
											</div>
										</div>
									</div>
									<div ng-show="o_reply"
										class="user-profile animate__animated animate__headShake img-thumbnail ng-scope"
										style="box-sizing: border-box; padding: 4px; border-radius: 5px; background-color: white; margin-bottom: 5px; margin-left: 5rem; width: 85%">
										<img ng-src="/images/{{myAccount.user.avatar}}"
											class="img-thumbnail" alt="">
										<div style="width: 70%">
											<small style="font-size: 12px;" class="ng-binding"> <i
												class="fa-regular fa-tag"></i> <label
												class="nhan ng-binding"
												style="font-size: 13px; color: #313131; font-weight: bolder;"><span class="nhan">Bạn đang trả lời: </span> {{comment.user.username}}</label>
											</small><br>
											<div >
												<form>
													<div class="input-group">
														<input type="text" class="form-control"
															ng-keydown="handleKeyDownReplyForComment($event, comment.user.userId, comment.commentId, replyContent[comment.commentId])"
															placeholder="Nhập nội dung..."
															ng-model="replyContent[comment.commentId]">
														<div class="input-group-append">
															<button class="btn btn-primary"
																style="background-color: #007ACC; color: white; border: none"
																type="button"
																ng-click="sendReplyForComment(comment.user.userId, comment.commentId, replyContent[comment.commentId])">Gửi</button>
														</div>
													</div>
												</form>
											</div>
										</div>
									</div>
									<div ng-show="o_checkbox">
										<div ng-repeat="obj in comment.reply | orderBy:'replyDate':true">
											<div
												class="user-profile animate__animated animate__headShake img-thumbnail ng-scope"
												style="box-sizing: border-box; padding: 4px; border-radius: 5px; background-color: white; margin-bottom: 5px; margin-left: 3rem; width: 85%">
												<img ng-src="/images/{{obj.responder.avatar}}"
													class="img-thumbnail" alt="">
												<div>
													<div>
														<label class="nhan ng-binding"
															style="font-size: 15px; color: #313131;">{{obj.responder.username}}</label>
													</div>
													<small style="font-size: 12px;" class="ng-binding">
														<i class="fa-regular fa-comments"></i> <label
														class="nhan ng-binding"
														style="font-size: 13px; color: #313131; font-weight: bolder;">{{obj.receiver.username}}</label>
														{{obj.replyContent}}
													</small><br>
													<div>
														<small style="font-size: 10px;" class="ng-binding">{{getFormattedTimeAgo(obj.replyDate)}}</small>
														&nbsp; <small style="font-size: 10px; cursor: pointer;">
															<label> <input type="checkbox"
																ng-model="o_reply2" hidden="true"> Trả lời
														</label>
														</small>
													</div>
												</div>
											</div>
											<div ng-show="o_reply2"
												class="user-profile animate__animated animate__headShake img-thumbnail ng-scope"
												style="box-sizing: border-box; padding: 4px; border-radius: 5px; background-color: white; margin-bottom: 5px; margin-left: 5rem; width: 85%">
												<img ng-src="/images/{{myAccount.user.avatar}}"
													class="img-thumbnail" alt="">
												<div style="width: 65%">
													<small style="font-size: 12px;" class="ng-binding">
														<i class="fa-regular fa-tag"></i> <label
														class="nhan ng-binding"
														style="font-size: 13px; color: #313131; font-weight: bolder;"><span class="nhan">Bạn đang trả lời: </span>{{obj.responder.username}}</label>
													</small><br>
													<div>
														<form>
															<div class="input-group">
																<input type="text" class="form-control"
																	placeholder="Nhập nội dung..."
																	ng-model="replyContent[obj.replyId]"
																	ng-keydown="handleKeyDown($event, obj.responder.userId, replyContent[obj.replyId], obj.replyId, comment.commentId)">

																<div class="input-group-append">
																	<button class="btn btn-primary"
																		style="background-color: #007ACC; color: white; border: none"
																		type="button"
																		ng-click="sendReply(obj.responder.userId, replyContent[obj.replyId], obj.replyId, comment.commentId)">Gửi</button>
																</div>
															</div>
														</form>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>



							</div>

						</div>


					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Modal báo cáo -->
	<div class="modal fade" id="modalBaoCao" tabindex="-1" role="dialog"
		aria-labelledby="modalTitleId" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="modalTitleId">Nội dung tố cáo</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"
						aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<select name="loaiViPham" id="viPham" class="form-control">
						<c:forEach var="viPham" items="${danhSachViPham}">
							<option value="${viPham.maLoai}">${viPham.chiTiet}</option>
						</c:forEach>
					</select>

				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary"
						data-bs-dismiss="modal">Đóng</button>
					<button type="button" class="btn btn-primary">Báo cáo</button>
				</div>
			</div>
		</div>
	</div>
	<!-- load ảnh -->
	<script>
  let input = document.getElementById('inputGroupFile01');
  let imageList = document.getElementById('imageList');

  input.onchange = (e) => {
    imageList.innerHTML = ''; // Xóa danh sách hình ảnh hiện tại

    for (let i = 0; i < input.files.length; i++) {
      let img = document.createElement('img');
      img.src = URL.createObjectURL(input.files[i]);
      img.className = 'uploaded-image';
      imageList.appendChild(img);
    }
  };
</script>

	<script>
        angular.module('myApp', [])
            .controller('myCtrl', function ($scope, $http) {
                $scope.Posts = [];
                $scope.likedPosts = [];
                $scope.myAccount = {};
                $scope.postData = {};
                $scope.postDetails = {};
                $scope.postComments =[];
                $scope.replyContent = {}; // Khởi tạo replyContent      
                
                

                $http.get('/findfollowing')
                    .then(function (response) {
                        var Posts = response.data;
                        $scope.Posts = Posts;
                    })
                    .catch(function (error) {
                        console.log(error);
                    });

                $http.get('/findlikedposts')
                    .then(function (response) {
                        var likedPosts = response.data;
                        $scope.likedPosts = likedPosts;
                    })
                    .catch(function (error) {
                        console.log(error);
                    });

                $http.get('/findmyaccount')
                    .then(function (response) {
                        var myAccount = response.data;
                        $scope.myAccount = myAccount;
                    })
                    .catch(function (error) {
                        console.log(error);
                    });
				
                $scope.saveImages = function() {
					
				}
                $scope.likePost = function (postId) {
                    var likedIndex = $scope.likedPosts.indexOf(postId.toString());
                    var likeEndpoint = '/likepost/' + postId;
                    var dislikeEndpoint = '/didlikepost/' + postId;

                    // Nếu postId chưa tồn tại trong mảng likedPosts
                    if (likedIndex === -1) {
                        // Thêm postId vào mảng likedPosts
                        $scope.likedPosts.push(postId.toString());

                        // Gửi yêu cầu POST để like bài viết và cập nhật likeCount+1
                        $http.post(likeEndpoint)
                            .then(function (response) {
                                
                                // Cập nhật thuộc tính likeCount+1 trong đối tượng post
                                var post = $scope.Posts.find(function (item) {
                                    return item.postId === postId;
                                });
                                if (post) {
                                    post.likeCount++;
                                    
                                }
                            })
                            .catch(function (error) {
                                // Xử lý lỗi
                                console.log(error);
                            });
                    } else {
                    	
                        // Xóa postId khỏi mảng likedPosts
                        $scope.likedPosts.splice(likedIndex, 1);
                        
                        // Gửi yêu cầu POST để dislike bài viết và cập nhật likeCount-1
                        $http.post(dislikeEndpoint)
                            .then(function (response) {                            	
                                // Xử lý thành công
                                //console.log(response.data);

                                // Cập nhật thuộc tính likeCount-1 trong đối tượng post
                                var post = $scope.Posts.find(function (item) {
                                    return item.postId === postId;
                                });
                                if (post) {
                                    post.likeCount--;
                                    
                                }
                            })
                            .catch(function (error) {
                                // Xử lý lỗi
                                console.log(error);
                            });
                    }
                };
                $scope.getFormattedTimeAgo = function(date) {
                	  var currentTime = new Date();
                	  var activityTime = new Date(date);
                	  var timeDiff = currentTime.getTime() - activityTime.getTime();
                	  var seconds = Math.floor(timeDiff / 1000);
                	  var minutes = Math.floor(timeDiff / (1000 * 60));
                	  var hours = Math.floor(timeDiff / (1000 * 60 * 60));
                	  var days = Math.floor(timeDiff / (1000 * 60 * 60 * 24));

                	  if (days === 0) {
                	    if (hours === 0 && minutes < 60) {
                	      if (seconds < 60) {
                	        return seconds + ' giây trước';
                	      } else {
                	        return minutes + ' phút trước';
                	      }
                	    } else if (hours < 24) {
                	      return hours + ' giờ trước';
                	    }
                	  } else if (days === 1) {
                	    return 'Hôm qua';
                	  } else {
                	    return days + ' ngày trước';
                	  }
                	};

              	$scope.post = function() {
              	  var content = $scope.postData.text;
              	
              	  var formData = new FormData();
              	  var fileInput = document.getElementById('inputGroupFile01');

              	  for (var i = 0; i < fileInput.files.length; i++) {
              	    formData.append('photoFiles', fileInput.files[i]);
              	    alert(fileInput.files[i])
              	  }
              	  formData.append('content', content.content);

              	  $http.post('/post', formData, {
              	    transformRequest: angular.identity,
              	    headers: { 'Content-Type': undefined }
              	  }).then(function(response) {
              		  alert("ok")
              	    // Xử lý phản hồi thành công từ máy chủ
              	    console.log(response.data);
              	  }, function(error) {
              	    // Xử lý lỗi
              	    console.log(error);
              	  });
              	};
              	
              	$scope.getPostDetails = function(postId) {                           	
              		$http.get('/findpostcomments/'+ postId)
              	  .then(function(response) {
              		  var postComments = response.data;
              		  $scope.postComments = postComments;                		  
              	    
              	    
              	    console.log(response.data);
              	  }, function(error) {
              	    // Xử lý lỗi
              	    console.log(error);
              	  });
              		
              		$scope.isReplyEmpty = true;
              		$http.get('/postdetails/'+ postId)
                	  .then(function(response) {
                		  var postDetails = response.data;
                		  $scope.postDetails = postDetails;                		  
                	    // Xử lý phản hồi thành công từ máy chủ
                	    $('#chiTietBaiViet').modal('show');
                	    
                	  }, function(error) {
                	    // Xử lý lỗi
                	    console.log(error);
                	  });  
                	};
                
                	
                	$scope.addComment = function(postId) {
                		  var myComment = $scope.myComment;
                		  $http.post('/addcomment/' + postId + '?myComment=' + myComment)
                		    .then(function(response) {
                		    	$scope.postComments.unshift(response.data);
                		      $scope.myComment = '';
                		      
                		      
                		    }, function(error) {
                		      console.log(error);
                		    });
                		};
                		

                		$scope.logout = function() {              			
                		    $http.get('/logout')
                		      .then(function() {               		    	
                		    	  window.location.href='/login';
                		      }, function(error) {
                		        console.log(error);
                		      });
                		  };
                		  
                		  
                		  $scope.sendReply = function(receiverId, replyContent, replyId, commentId) {               			   
                			    var requestData = {
                			        receiverId: receiverId,               			        
                			        replyContent: replyContent,
                			        commentId: commentId
                			    };               			                  			 
                			    $http.post('/addreply', requestData)
                			        .then(function(response) {               			            
                			            var comment = $scope.postComments.find(function(comment) {
                			                return comment.commentId === commentId;
                			            });
                			            comment.reply.unshift(response.data);
                			            $scope.replyContent[replyId] = '';             			            
                			        })
                			        .catch(function(error) {
                			            // Xử lý lỗi
                			            console.log('Lỗi:', error);
                			        });
                			    
                			};
                			
                			$scope.sendReplyForComment = function(receiverId,commentId, replyContent) {               			   
                			    var requestData = {
                			        receiverId: receiverId,               			        
                			        replyContent: replyContent,
                			        commentId: commentId
                			    };               			 
                			    $http.post('/addreply', requestData)
                			        .then(function(response) {               			            
                			            var comment = $scope.postComments.find(function(comment) {
                			                return comment.commentId === commentId;
                			            });
                			            comment.reply.unshift(response.data);
                			            $scope.replyContent[commentId] = '';   
                			            
                			        })
                			        .catch(function(error) {
                			            // Xử lý lỗi
                			            console.log('Lỗi:', error);
                			        });
                			    
                			};
                			$scope.handleKeyDown = function(event, userId, replyContent, replyId, commentId) {
                			    if (event.keyCode === 13) {
                			        // Người dùng đã nhấn phím Enter
                			        $scope.sendReply(userId, replyContent, replyId, commentId);
                			    }
                			};
                			
                			$scope.handleKeyDownReplyForComment = function(event, receiverId,commentId, replyContent) {
                			    if (event.keyCode === 13) {
                			        // Người dùng đã nhấn phím Enter
                			        $scope.sendReplyForComment(receiverId,commentId, replyContent);
                			    }
                			};




            });            
    </script>
</body>

</html>

</html>