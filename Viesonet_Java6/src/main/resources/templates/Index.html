<!doctype html>
<html ng-app="myApp">

<head>
<!-- Required meta tags -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link rel="stylesheet"
	href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@200;300;400;500;600;700;800&display=swap">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
	crossorigin="anonymous">
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
	crossorigin="anonymous"></script>
<script src="https://kit.fontawesome.com/f737751420.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
	href="https://fonts.googleapis.com/css2?family=Alumni+Sans+Inline+One&family=Bangers&family=Chakra+Petch:ital,wght@0,400;1,300;1,400;1,700&family=Grenze&family=Patrick+Hand&family=Playfair+Display+SC&family=Road+Rage&display=swap"
	rel="stylesheet">
<link rel="stylesheet" href="/css/style.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
	href="https://fonts.googleapis.com/css2?family=Alumni+Sans+Inline+One&family=Bangers&family=Chakra+Petch:ital,wght@0,400;1,300;1,400;1,700&family=Grenze&family=Patrick+Hand&family=Roboto&display=swap"
	rel="stylesheet">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script
	src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
<!-- Thêm thư viện SockJS và Stomp -->
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.1/sockjs.min.js"></script>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<title>Trang chủ</title>
<style type="text/css">
body {
	font-family: 'Plus Jakarta Sans', sans-serif;
}

.dropdown-item {
	padding-top: 0;
	padding-bottom: 0;
}

.red-heart {
	color: red;
	/* Màu đỏ cho trái tim đã thích */
}

.gray-heart {
	color: gray;
	/* Màu xám cho trái tim chưa thích */
}

div.dropdown-menu.baoCao {
	transform: translate(-80%, 39px);
}

.container, .container-lg, .container-md, .container-sm, .container-xl {
	max-width: 100%;
}

.dropdown {
	position: relative;
	display: inline-block;
}

.dropdown-content {
	display: none;
	opacity: 0;
	position: absolute;
	background-color: #f9f9f9;
	min-width: 17rem;
	box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
	z-index: 1;
	padding-right: 10px;
	border-radius: 3px;
	transition: 0.5s ease-in-out;
}

.dropdown-content a {
	color: black;
	padding: 12px 16px;
	text-decoration: none;
	display: block;
}

.dropdown:hover .dropdown-content {
	display: block;
	transition: 0.5s ease-in-out;
	opacity: 1;
}

.uploaded-image {
	width: 100%;
	max-width: 100%;
	height: auto;
	margin-bottom: 7px;
}

.image-link {
	padding: 10px;
	display: flex;
	align-items: center;
	text-decoration: none;
	color: #989692;
	display: flex;
}

.notification {
	border-radius: 10px;
	background-color: rgba(93, 135, 255, 0.1);
	color: #5D87FF;
}

.content {
	display: flex;
	flex-direction: column;
	margin-left: 10px;
	display: flex;
}

.content p {
	margin-bottom: 0;
}
</style>

<script
	src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
<script src="/js/thoiTiet.js"></script>
</head>

<body style="padding-top: 70px;" ng-controller="myCtrl">
	<div style="transition: 0.5s;">
		<div class="row ">
			<div ng-include="'_menuLeft.html'"></div>
			<nav ng-include="'_header.html'" class="navbar navbar-expand-sm "
				style="padding: 0; position: fixed; top: 0; z-index: 101">
				<div class="container" style="width: 100%; padding: 0;">
					<div class="collapse navbar-collapse" id="collapsibleNavId">
						<ul class="navbar-nav me-auto mt-2 mt-lg-0">
						</ul>
						<div class="body-wrapper">
							<header class="app-header">
								<nav class="navbar navbar-expand-lg navbar-light">
									<div class="navbar-collapse justify-content-end px-0"
										id="navbarNav">
										<ul
											class="navbar-nav flex-row ms-auto align-items-center justify-content-end">
											<li class="nav-item dropdown"><a
												data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight"
												aria-controls="offcanvasRight"
												class="nav-link nav-icon-hover" href="#">
													<div class="notification-icon">
														<i class="fa-regular fa-bell fa-lg"></i>
														<div class="circle">
															<span>5+</span>
														</div>
													</div>
											</a></li>
											<li class="nav-item dropdown"><a
												class="nav-link nav-icon-hover" href="#" id="drop2"
												data-bs-toggle="dropdown" aria-expanded="false"> <img
													src="images/duyQuy.jpg" alt="" width="35" height="35"
													class="rounded-circle">
											</a>
												<div class="dropdown-menu dropdown-menu-end"
													aria-labelledby="drop2">
													<div class="message-body">
														<a href="/changepassword"
															class="d-flex align-items-center gap-2 dropdown-item">
															<i class="ti ti-user fs-6"></i>
															<p class="mb-0 fs-3">Đổi mật khẩu</p>
														</a> <a href="#"
															class="d-flex align-items-center gap-2 dropdown-item">
															<i class="ti ti-mail fs-6"></i>
															<p class="mb-0 fs-3">Thông tin điều khoản</p>
														</a> <a href="#"
															class="d-flex align-items-center gap-2 dropdown-item">
															<i class="ti ti-list-check fs-6"></i>
															<p class="mb-0 fs-3">Nâng cấp</p>
														</a> <a ng-click="logout()"
															class="btn btn-outline-primary mx-3 mt-2 d-block">Đăng
															xuất</a>
													</div>
												</div></li>
										</ul>
									</div>
								</nav>
							</header>
							<div class="container-fluid">
								<div class="row"></div>
							</div>

						</div>
					</div>
				</div>
			</nav>

			<div class="col-md-7 offset-md-2 "
				style="z-index: 10; padding-left: 3rem">
				<center>
					<div
						style="width: 85%; text-align: left; background-color: transparent;"
						data-bs-toggle="modal" href="#exampleModalToggle">
						<div>
							<div
								class="write-post-container  img-thumbnail animate__animated animate__backInLeft"
								style="margin-bottom: 15px; background: white 0.5; border-radius: 3px 3px 0 0; padding-top: 10px; padding-bottom: 10px; background-color: transparent; background-image: url('/images/nenDn.jpeg'); background-size: cover; min-height: 10rem;">
								<span
									style="font-weight: 600 !important; font-size: 1rem !important; margin: 0; color: white"><i
									class="fa-solid fa-pencil"></i> Đăng bài viết</span>
								<form id="postForm">
									<center>
										<img id="img" src="" width="45%"
											style="border-radius: 10px; border: 1px solid rgb(184, 182, 182)">
									</center>
									<div class="form-control" id="floatingTextarea2"
										style="height: 57px; opacity: 0.7; border-radius: 0px 15px 0px 15px;">Hãy
										viết gì đó cho ngày hôm nay...</div>
								</form>
								<div class="d-flex  gap-2"
									style="margin-top: 5px; text-align: right;"></div>
							</div>
						</div>
					</div>
				</center>

				<center>
					<div ng-repeat="post in Posts">
						<div
							class="write-post-container   animate__animated animate__backInLeft"
							style="margin-bottom: 20px; border-radius: 2px; padding: 0; padding-top: 10px; padding-bottom: 10px; width: 85%; text-align: left; background: white;">
							<div style="margin: 0;">
								<div
									style="display: flex; align-items: center; justify-content: space-between; padding-left: 10px">
									<div class="dropdown">
										<span class="dropbtn">
											<div class="user-profile ">
												<a href="/nguoiDung/0111111118"><img
													ng-src="/images/{{post.user.avatar }}"
													style="border-radius: 100%;" alt=""></a>
												<div>

													<span
														style="font-weight: 600 !important; font-size: 1rem !important; margin: 0; color: #2A3547">{{
														post.user.username }}</span> &nbsp;&nbsp; <span><small
														style="font-size: 12px; color: #65676b"> {{
															getFormattedTimeAgo(post.postDate) }} </small></span>
												</div>
											</div>
										</span>
										<div class="dropdown-content">
											<div class="user-profile ">
												<a href="/nguoiDung/0111111118"><img
													ng-src="/images/{{ post.user.avatar }}"
													style="border-radius: 100%;" alt=""></a>
												<div>
													<label>{{ post.user.username }}</label>
													<!-- <i class="fa-solid fa-earth-americas fa-xs"></i> -->
													<br> <small style="font-size: 12px; color: #65676b">
														<b>Sống tại:</b> {{ post.user.address }}
													</small> <br> <small style="font-size: 12px; color: #65676b">
														<b>Mối quan hệ:</b> {{ post.user.relationship }}
													</small>

												</div>
											</div>
										</div>
									</div>

									<div>
										<div class="btn-group" style="margin-right: 10px;">
											<div class="dropdown">
												<span class="  dropdown-toggle" id="triggerId"
													data-bs-toggle="dropdown" aria-haspopup="true"
													aria-expanded="false"> </span>
												<div class="dropdown-menu" aria-labelledby="triggerId">
													<a class="dropdown-item"
														ng-click="openModalBaoCao(post.postId)"
														style="color: #E53F31; font-size: 13px">Báo cáo vi
														phạm</a>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div style="margin-top: 10px;">
									<div>
										<div
											style="box-sizing: border-box; padding: 10px; font-size: 14px;">
											{{ post.content }}</div>
										<center>
											<div ng-if="post.images.length > 1">
												<!-- Carousel HTML code -->
												<div id="carouselId{{post.postId}}" class="carousel slide"
													data-bs-ride="carousel">
													<!-- Carousel indicators -->
													<ol class="carousel-indicators">
														<li data-bs-target="#carouselId"
															ng-repeat="image in post.images track by $index"
															ng-class="{ 'active': $index === 0 }"
															data-bs-slide-to="{{$index}}"
															aria-current="{{$index === 0}}"
															aria-label="Slide {{$index + 1}}"></li>
													</ol>
													<!-- Carousel items -->
													<div class="carousel-inner" role="listbox">
														<div class="carousel-item"
															style="background-color: #313131; height: 90vh;"
															ng-repeat="image in post.images track by $index"
															ng-class="{ 'active': $index === 0 }">

															<img ng-click="getPostDetails(post.postId)"
																ng-if="image.type === true"
																ng-src="/images/{{ image.imageUrl }}"
																class="w-100 d-block" alt="Slide {{$index + 1}}"
																style="max-height: 90vh; object-fit: contain; width: 100%; transform: translateY(-50%); top: 50%; position: absolute;">

															<video ng-if="image.type === false" autoplay controls
																style="max-height: 90vh; object-fit: contain; width: 100%; transform: translate(-50%, -50%); top: 50%; position: absolute;">
																<source ng-src="images/{{ image.imageUrl }}"
																	type="video/mp4">
																Your browser does not support the video tag.
															</video>
														</div>
													</div>

													<!-- Carousel controls -->
													<button class="carousel-control-prev" type="button"
														data-bs-target="#carouselId{{post.postId}}"
														data-bs-slide="prev">
														<span class="carousel-control-prev-icon"
															aria-hidden="true"></span> <span class="visually-hidden">Previous</span>
													</button>
													<button class="carousel-control-next" type="button"
														data-bs-target="#carouselId{{post.postId}}"
														data-bs-slide="next">
														<span class="carousel-control-next-icon"
															aria-hidden="true"></span> <span class="visually-hidden">Next</span>
													</button>
												</div>
											</div>
											<div ng-if="post.images.length === 1">
												<video ng-if="post.images[0].type === false"
													ng-click="getPostDetails(post.postId)" autoplay controls
													style="width: 100%;">
													<source ng-src="images/{{ post.images[0].imageUrl }}"
														type="video/mp4">
													Your browser does not support the video tag.
												</video>
												<!-- Single image HTML code -->
												<img ng-if="post.images[0].type === 'true'"
													ng-click="getPostDetails(post.postId)"
													ng-src="/images/{{ post.images[0].imageUrl }}"
													class="w-100" alt="Single image">
											</div>



										</center>
									</div>

									<div class="post-reaction"
										style="padding: 10px; margin-top: 8px;">
										<div class="activity-icons">
											<div>
												<span ng-click="likePost(post.postId);"
													ng-if="likedPosts.indexOf(post.postId.toString()) !== -1"
													style="color: #f50000;">❤️&nbsp;{{ post.likeCount }}</span>
												<span ng-click="likePost(post.postId)"
													ng-if="likedPosts.indexOf(post.postId.toString()) === -1">🤍&nbsp;{{
													post.likeCount }}</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span
													ng-click="getPostDetails(post.postId)"><i
													class="fa-light fa-comments"></i>&nbsp;{{ post.commentCount
													}}</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span><i
													class="fa-light fa-share-nodes"></i></span>
											</div>
										</div>
									</div>

								</div>
							</div>
						</div>
					</div>
				</center>
			</div>
			<div class="col-md-3 menuLeft animate__animated animate__backInRight"
				style="position: fixed; right: 3%; top: 70px;">
				<div class="user-data full-width"
					style="margin-bottom: 5px; margin-left: 0">
					<div class="user-profile" style="display: block;">
						<div class="username-dt dpbg-1"
							style="background-image: url(images/{{myAccount.user.background}}); background-size: cover;">
							<div class="usr-pic">
								<img ng-src="/images/{{myAccount.user.avatar}}" alt="">
							</div>
						</div>
						<div class="user-main-details">
							<h6 style="font-weight: 600">{{myAccount.user.username}}</h6>
							<!-- <span><i class="feather-map-pin"></i>India</span> -->
						</div>
						<ul class="followers-dts">
							<li>
								<div class="followers-dt-sm">
									<h4>Người theo dõi</h4>
									<span>{{myAccount.followers}}</span>
								</div>
							</li>
							<li>
								<div class="followers-dt-sm">
									<h4>Đang theo dõi</h4>
									<span>{{myAccount.following}}</span>
								</div>
							</li>
						</ul>
						<div class="profile-link">

							<a class="btn-blue" href="/profile"
								style="background-color: #3b5998; border-radius: 2px; border: 1px solid #3b5998; box-sizing: border-box; color: white; display: inline-block; font-family: Arial, sans-serif; font-size: 14px; line-height: 16.8px; margin: 0px 3px 10px; padding: 10px 14px; text-decoration-line: none; transition: all 0.2s; width: 98%;"
								rel="noopener noreferrer"><i
								class="fa-light fa-address-card"></i> Xem trang cá nhân </a>
						</div>

					</div>
				</div>
				<div class="row">
					<div>
						<div
							style="background-color: #f2f2f2; border: 1px solid grey; background: url(images/beach.jpg); background-size: cover; color: #234662; padding: 0; width: 100%; max-height: 188px; border-radius: 3px">
							<div id="weather-info"
								style="background-color: rgba(0, 0, 0, 0.4); margin: 0; padding: 10px; color: #F2E5C9;">

								<ul style="font-size: 13px">
									<li><b>Thành phố:</b> <span id="city"></span></li>
									<li><b>Nhiệt độ:</b> <span id="temperature"></span> °C</li>
									<li><b>Mô tả:</b> <span id="description"></span></li>
									<li><b>Độ ẩm:</b> <span id="humidity"></span>%</li>
									<li><b>Tốc độ gió:</b> <span id="wind-speed"></span> m/s</li>
								</ul>
							</div>
						</div>
					</div>
				</div>

			</div>
		</div>
	</div>
	<!-- Modal đăng bài -->
	<div class="modal fade" id="exampleModalToggle" aria-hidden="true"
		aria-labelledby="exampleModalToggleLabel" tabindex="-1">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content"
				style="background-color: rgba(246, 245, 244, 1);">
				<div class="modal-header">
					<h5 class="modal-title" id="exampleModalToggleLabel">
						<b style="margin-left: 170px;">Đăng bài viết</b>
					</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"
						aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<form id="postForm" enctype="multipart/form-data">
						<div class="user-profile">
							<img ng-src="images/{{ myAccount.user.avatar }}" alt="">
							<div>
								<label>{{myAccount.user.username}}</label> <br>
								<div style="display: flex; align-items: center;">
									<div class="circle2 mb-2"
										style="margin-bottom: 0 !important; background-color: green"></div>
									&nbsp; <small style="font-size: 12px"> Đang hoạt động </small>
								</div>
							</div>
						</div>
						<br>
						<textarea name="content" placeholder="Bạn đang nghĩ gì?"
							id="content" ng-model="content" cols="30" rows="3"
							style="width: 100%; border: 0px; outline: none; border-bottom: 1px solid #ccc; background: transparent; resize: none;"></textarea>
						<br>
						<div id="dropArea" ondrop="dropHandler(event);"
							ondragover="dragOverHandler(event);"
							ondragleave="dragLeaveHandler(event);">Chọn hoặc kéo thả để
							tải hình ảnh/video.</div>

						<div class="input-group mb-3">
							<label class="input-group-text" for="inputGroupFile01"> <i
								class="fa-regular fa-image"></i>Hình ảnh và video
							</label> <input type="file" class="form-control" name="mediaFiles"
								id="inputGroupFile01" multiple>
						</div>

						<div id="mediaList"></div>
					</form>
				</div>
				<div class="modal-footer">
					<button ng-click="post()" style="width: 500px; border: none;"
						class="btn-blue" data-bs-target="#exampleModalToggle2"
						data-bs-toggle="modal" data-bs-dismiss="modal">Đăng bài</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal hiện  chi tiêt bài viết và danh sách bình luận -->
	<div class="modal fade" id="chiTietBaiViet" tabindex="-1" role="dialog"
		aria-labelledby="modalTitleId" aria-hidden="true">
		<div class="modal-dialog modal-xl modal-fullscreen" role="document">
			<div class="modal-content">
				<div class="modal-body">
					<div class="row">
						<div ng-if="postDetails.images.length > 0" class="col-md-6 trai "
							style="overflow-y: scroll; max-height: 100vh">
							<center>
								<center>
									<div ng-if="postDetails.images.length > 1">
										<!-- Carousel HTML code -->
										<div id="postDetails{{postDetails.postid}}"
											class="carousel slide" data-bs-ride="carousel">
											<!-- Carousel indicators -->
											<ol class="carousel-indicators">
												<li data-bs-target="#postDetails{{postDetails.postid}}"
													ng-repeat="image in postDetails.images track by $index"
													ng-class="{ 'active': $index === 0 }"
													data-bs-slide-to="{{$index}}"
													aria-current="{{$index === 0}}"
													aria-label="Slide {{$index + 1}}"></li>
											</ol>
											<!-- Carousel items -->
											<div class="carousel-inner" role="listbox">
												<div class="carousel-item"
													ng-repeat="image in postDetails.images track by $index"
													ng-class="{ 'active': $index === 0 }">
													<img ng-src="/images/{{ image.imageUrl }}"
														class="w-100 d-block" alt="Slide {{$index + 1}} ">
												</div>
											</div>
											<!-- Carousel controls -->
											<button class="carousel-control-prev" type="button"
												data-bs-target="#postDetails{{postDetails.postid}}"
												data-bs-slide="prev">
												<span class="carousel-control-prev-icon" aria-hidden="true"></span>
												<span class="visually-hidden">Previous</span>
											</button>
											<button class="carousel-control-next" type="button"
												data-bs-target="#postDetails{{postDetails.postid}}"
												data-bs-slide="next">
												<span class="carousel-control-next-icon" aria-hidden="true"></span>
												<span class="visually-hidden">Next</span>
											</button>
										</div>
									</div>
									<div ng-if="postDetails.images.length === 1">
										<!-- Single image HTML code -->
										<img ng-src="/images/{{ postDetails.images[0].imageUrl }}"
											class="w-100" alt="Single image"
											style="margin-top: 10px; margin-bottom: 10px; max-height: 90vh; object-fit: cover;">
									</div>
								</center>
							</center>
						</div>
						<div class="col-md-6 phai ">
							<div>
								<div data-bs-dismiss="modal"
									style="cursor: pointer; text-align: right;">x</div>
								<div
									style="display: flex; align-items: center; justify-content: space-between;">
									<div class="user-profile ">
										<a href="/nguoiDung/{{postDetails.user.userId}}"><img
											ng-src="/images/{{postDetails.user.avatar}}"
											style="border-radius: 100%;" alt=""></a>
										<div>

											<span
												style="font-weight: 600 !important; font-size: 1rem !important; margin: 0; color: #2A3547"
												class="ng-binding">{{postDetails.user.username}}</span>
											&nbsp;&nbsp; <span><small
												style="font-size: 12px; color: #65676b" class="ng-binding">
													{{getFormattedTimeAgo(postDetails.postDate)}} </small></span>
										</div>
									</div>

									<div>
										<div class="btn-group">
											<span class="btn dropdown-toggle" type="button"
												id="triggerId" data-bs-toggle="dropdown"
												aria-haspopup="true" aria-expanded="false"></span>
											<div class="dropdown-menu" aria-labelledby="triggerId">
												<a class="dropdown-item" href="#">Báo cáo vi phạm</a>
											</div>
										</div>
									</div>
								</div>
								<div style="padding: 10px">{{postDetails.content}}</div>
								<form>
									<div style="display: flex;">
										<input ng-model="myComment" type="text"
											class="ip form-control" style="width: 80%;"
											placeholder="Bình luận của bạn" required="">
										<button class="btn01" type="submit"
											style="background: #007ACC; color: white; width: 20%; height: 50%; border-radius: 5px; transform: translateY(85%); margin-left: 0.2rem;"
											ng-click="addComment(postDetails.postId)">Bình luận</button>
									</div>
								</form>
							</div>
							<center>
								<hr style="width: 10%; text-align: center;">
							</center>
							<div
								style="overflow-y: scroll; max-height: 60vh; padding-right: 0.2rem">
								<div
									ng-repeat="comment in postComments | limitTo:numOfCommentsToShow">
									<div class="msg ng-scope left-msg" ng-class="left-msg">
										<div class="msg-img"
											style="background-image: url(/images/{{comment.user.avatar}}); transform: translateY(-100%); border: 1px solid #ebf1f6;"></div>
										<div class="msg-bubble" style="border-radius: 15px">

											<div>
												<div>
													<label class="nhan"
														style="font-size: 15px; font-size: 1rem !important; margin: 0; color: #050505;">{{comment.user.username}}</label>
												</div>
												<small style="font-size: 12px;"> <svg
														class="svg-inline--fa fa-comment" aria-hidden="true"
														focusable="false" data-prefix="far" data-icon="comment"
														role="img" xmlns="http://www.w3.org/2000/svg"
														viewBox="0 0 512 512" data-fa-i2svg="">
                          <path fill="currentColor"
															d="M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c8.6 9.7 12.8 22.5 11.8 35.5c-1.4 18.1-5.7 34.7-11.3 49.4c17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9c1.8-2.7 3.5-5.4 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208s-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6c-15.1 6.6-32.3 12.6-50.1 16.1c-.8 .2-1.6 .3-2.4 .5c-4.4 .8-8.7 1.5-13.2 1.9c-.2 0-.5 .1-.7 .1c-5.1 .5-10.2 .8-15.3 .8c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c4.1-4.2 7.8-8.7 11.3-13.5c1.7-2.3 3.3-4.6 4.8-6.9c.1-.2 .2-.3 .3-.5z">
                          </path>
                        </svg> {{comment.content}}
												</small><br>
												<div>
													<small style="font-size: 10px;">{{getFormattedTimeAgo(comment.commentDate)}}</small>
													&nbsp; <label> <input type="checkbox"
														ng-model="o_checkbox" hidden="true"> <small
														ng-if="comment.reply.length > 0"
														style="font-size: 10px; cursor: pointer;">{{comment.reply.length}}
															phản hồi</small>
													</label> &nbsp; <small style="font-size: 10px; cursor: pointer;">
														<label> <input type="checkbox" ng-model="o_reply"
															hidden="true"> <i
															class="fa-sharp fa-regular fa-reply"></i> Trả lời
													</label>
													</small>
												</div>
											</div>

										</div>
									</div>

									<div ng-show="o_reply"
										class="user-profile animate__animated animate__headShake img-thumbnail ng-scope"
										style="box-sizing: border-box; padding: 4px; border-radius: 5px; background-color: white; margin-bottom: 5px; margin-left: 5rem; width: 85%">
										<img ng-src="/images/{{myAccount.user.avatar}}"
											class="img-thumbnail" alt="">
										<div style="width: 70%">
											<small style="font-size: 12px;" class="ng-binding"> <i
												class="fa-regular fa-tag"></i> <label
												class="nhan ng-binding"
												style="font-size: 13px; color: #313131; font-weight: bolder;"><span
													class="nhan">Bạn đang trả lời: </span>
													{{comment.user.username}}</label>
											</small><br>
											<div>
												<form>
													<div class="input-group">
														<input type="text" class="form-control"
															ng-keydown="handleKeyDownReplyForComment($event, comment.user.userId, comment.commentId, replyContent[comment.commentId])"
															placeholder="Nhập nội dung..."
															ng-model="replyContent[comment.commentId]">
														<div class="input-group-append">
															<button class="btn btn-primary"
																style="background-color: #007ACC; color: white; border: none"
																type="button"
																ng-click="sendReplyForComment(comment.user.userId, comment.commentId, replyContent[comment.commentId])">Gửi</button>
														</div>
													</div>
												</form>
											</div>
										</div>
									</div>
									<div ng-show="o_checkbox">
										<div
											ng-repeat="obj in comment.reply | orderBy:'replyDate':true">
											<div
												class="user-profile animate__animated animate__headShake img-thumbnail ng-scope"
												style="box-sizing: border-box; padding: 4px; border-radius: 5px; background-color: white; margin-bottom: 5px; margin-left: 3rem; width: 85%">
												<img ng-src="/images/{{obj.responder.avatar}}"
													class="img-thumbnail" alt="">
												<div>
													<div>
														<label class="nhan ng-binding"
															style="font-size: 15px; color: #313131;">{{obj.responder.username}}</label>
													</div>
													<small style="font-size: 12px;" class="ng-binding">
														<i class="fa-regular fa-comments"></i> <label
														class="nhan ng-binding"
														style="font-size: 13px; color: #313131; font-weight: bolder;">{{obj.receiver.username}}</label>
														{{obj.replyContent}}
													</small><br>
													<div>
														<small style="font-size: 10px;" class="ng-binding">{{getFormattedTimeAgo(obj.replyDate)}}</small>
														&nbsp; <small style="font-size: 10px; cursor: pointer;">
															<label> <input type="checkbox"
																ng-model="o_reply2" hidden="true"> Trả lời
														</label>
														</small>
													</div>
												</div>
											</div>
											<div ng-show="o_reply2"
												class="user-profile animate__animated animate__headShake img-thumbnail ng-scope"
												style="box-sizing: border-box; padding: 4px; border-radius: 5px; background-color: white; margin-bottom: 5px; margin-left: 5rem; width: 85%">
												<img ng-src="/images/{{myAccount.user.avatar}}"
													class="img-thumbnail" alt="">
												<div style="width: 65%">
													<small style="font-size: 12px;" class="ng-binding">
														<i class="fa-regular fa-tag"></i> <label
														class="nhan ng-binding"
														style="font-size: 13px; color: #313131; font-weight: bolder;"><span
															class="nhan">Bạn đang trả lời: </span>{{obj.responder.username}}</label>
													</small><br>
													<div>
														<form>
															<div class="input-group">
																<input type="text" class="form-control"
																	placeholder="Nhập nội dung..."
																	ng-model="replyContent[obj.replyId]"
																	ng-keydown="handleKeyDown($event, obj.responder.userId, replyContent[obj.replyId], obj.replyId, comment.commentId)">

																<div class="input-group-append">
																	<button class="btn btn-primary"
																		style="background-color: #007ACC; color: white; border: none"
																		type="button"
																		ng-click="sendReply(obj.responder.userId, replyContent[obj.replyId], obj.replyId, comment.commentId)">Gửi</button>
																</div>
															</div>
														</form>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<button class="form-control"
									ng-show="numOfCommentsToShow < postComments.length"
									ng-click="showMoreComments()">Hiển thị thêm bình luận</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Thông báo -->
	<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight"
		aria-labelledby="offcanvasRightLabel">
		<div class="offcanvas-header">
			<h4 id="offcanvasRightLabel">Thông báo</h4>
			<button type="button" class="btn-close text-reset"
				data-bs-dismiss="offcanvas" aria-label="Close"></button>
		</div>
		<div class="offcanvas-body">
			<div class="bd-example">
				<ul class="nav nav-pills" data-toggle="slider-tab" id="myTab"
					role="tablist">
					<li class="nav-item" role="presentation">
						<button class="nav-link active" id="home-tab" data-bs-toggle="tab"
							data-bs-target="#pills-home1" type="button" role="tab"
							aria-controls="home" aria-selected="true">Chưa đọc</button>
					</li>
					<li class="nav-item" role="presentation">
						<button class="nav-link" id="profile-tab" data-bs-toggle="tab"
							data-bs-target="#pills-profile1" type="button" role="tab"
							aria-controls="profile" aria-selected="false">Tất cả</button>
					</li>
				</ul>
				<div class="tab-content" id="pills-tabContent">
					<div class="tab-pane fade show active" id="pills-home1"
						role="tabpanel" aria-labelledby="pills-home-tab1">
						<ul class="sidebar-scrollable mt-3">
							<li class="sidebar-item notification mt-1"
								ng-repeat="notify in notification"><a href="/profile"
								ng-click="seen(notify.notificationId)" class="image-link"
								ng-if="notify.receiver.userId == myAccount.user.userId"> <img
									src="/images/{{notify.receiver.avatar}}" width="55" height="55"
									style="object-fit: cover;" class="rounded-circle">
									<div class="content">
										<b>{{ notify.notificationContent }}</b>
										<p>{{ getFormattedTimeAgo(notify.notificationDate) }}
										<p>
									</div>
							</a></li>
						</ul>
					</div>
					<div class="tab-pane fade" id="pills-profile1" role="tabpanel"
						aria-labelledby="pills-profile-tab1">
						<ul class="sidebar-scrollable  hover mt-4">
							<li class="sidebar-item mt-1"
								ng-class="{'notification': allnotify.notificationStatus == true, '': allnotify.notificationStatus == false}"
								ng-repeat="allnotify in allNotification"><a href="/profile"
								ng-click="seen(allnotify.notificationId)" class="image-link">
									<img src="/images/{{allnotify.receiver.avatar}}" alt=""
									width="55" height="55" class="rounded-circle"
									style="object-fit: cover;">
									<div class="content">
										<b>{{ allnotify.notificationContent }}</b>
										<p>{{ getFormattedTimeAgo(allnotify.notificationDate) }}
										<p>
									</div>
							</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Modal báo cáo -->
	<div class="modal fade" id="modalBaoCao" tabindex="-1" role="dialog"
		aria-labelledby="modalTitleId" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="modalTitleId">Nội dung tố cáo</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"
						aria-label="Close"></button>
				</div>
				<div class="modal-body" style="line-height: 30px">
					<div ng-repeat="violation in violations">
						<label> <input type="radio" name="violationOption"
							ng-model="$parent.selectedViolationType"
							ng-value="violation.violationTypeId">
							{{violation.violationDescription}}
						</label>
					</div>

				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary"
						style="background-color: white; color: gray"
						data-bs-dismiss="modal">Đóng</button>
					<button type="button" class="btn btn-primary"
						style="background-color: #F27323; border: none"
						ng-click=report(selectedPostId)>Báo cáo</button>
				</div>
			</div>
		</div>
	</div>
	<!-- load ảnh -->
	<script>
		var selectedMedia = []; // Mảng để lưu trữ các tệp đã chọn từ cả hai lần chọn hình ảnh

		document.getElementById('dropArea').addEventListener('click',
				function() {
					document.getElementById('inputGroupFile01').click();
				});

		document.getElementById('inputGroupFile01').addEventListener('change',
				function() {
					handleFiles(this.files);
				});

		function dropHandler(event) {
			event.preventDefault();
			var files = event.dataTransfer.files;
			handleFiles(files);
		}

		function handleFiles(files) {
			var mediaType = /^image\//;
			var videoType = /^video\//;
			var mediaList = document.getElementById('mediaList');

			for (var i = 0; i < files.length; i++) {
				var file = files[i];
				if (mediaType.test(file.type) || videoType.test(file.type)) {
					var reader = new FileReader();
					reader.onload = (function(file) {
						return function() {
							if (mediaType.test(file.type)) {
								var media = new Image();
								media.src = this.result;
								media.classList.add('previewMedia');
								var container = createMediaContainer(media,
										file);
								mediaList.appendChild(container);
							} else if (videoType.test(file.type)) {
								var media = document.createElement('video');
								media.src = this.result;
								media.setAttribute('controls', 'controls');
								media.classList.add('previewMedia');
								var container = createMediaContainer(media,
										file);
								mediaList.appendChild(container);
							}
						};
					})(file);
					reader.readAsDataURL(file);
					selectedMedia.push(file);
				}
			}

			// Cập nhật lại những ảnh hoặc video đã chọn trong phần tử <input>
			var dataTransfer = new DataTransfer();
			for (var i = 0; i < selectedMedia.length; i++) {
				dataTransfer.items.add(selectedMedia[i]);
			}
			document.getElementById('inputGroupFile01').files = dataTransfer.files;
		}

		function createMediaContainer(media, file) {
			var container = document.createElement('div');
			container.classList.add('previewMediaContainer');
			container.appendChild(media);

			var deleteButton = document.createElement('button');
			deleteButton.innerHTML = 'X';
			deleteButton.classList.add('deleteButton');
			deleteButton
					.addEventListener(
							'click',
							function() {
								// Xóa hình ảnh khỏi giao diện và khỏi mảng selectedMedia khi người dùng xóa
								var index = selectedMedia.indexOf(file);
								if (index !== -1) {
									selectedMedia.splice(index, 1);
								}
								// Cập nhật lại những ảnh hoặc video đã chọn trong phần tử <input>
								var dataTransfer = new DataTransfer();
								for (var i = 0; i < selectedMedia.length; i++) {
									dataTransfer.items.add(selectedMedia[i]);
								}
								document.getElementById('inputGroupFile01').files = dataTransfer.files;

								container.remove();
							});

			container.appendChild(deleteButton);

			return container;
		}

		function dragOverHandler(event) {
			event.preventDefault();
			event.target.classList.add('active');
		}

		function dragLeaveHandler(event) {
			event.preventDefault();
			event.target.classList.remove('active');
		}
	</script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.1/sockjs.min.js"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>

	<script src="js/Index.js">
		
	</script>


</body>

</html>

</html>